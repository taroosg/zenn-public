---
title: "Laravel Sailã§ä½œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’GitHub Codespacesã§æ‰±ã†"
emoji: "ğŸ‘¾"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["laravel", "github", "codespaces"]
published: true
---

## çŠ¶æ³

Laravel Sail ã§ä½œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒå­˜åœ¨ã™ã‚‹ï¼GitHub ã§ã‚³ãƒ¼ãƒ‰ã‚’ç®¡ç†ã—ã¦ã„ã‚‹ã®ã§ Codespaces ã§æ‰±ã„ãŸã„ï¼

ãŒã€Sail ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã—ã¦ã‚‚ URL ãŒ localhost ã§å›ºå®šã•ã‚Œã¦ã„ã‚‹ãŸã‚ï¼Œæœ€åˆã®ãƒšãƒ¼ã‚¸ä»¥å¤– Codespaces ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ï¼

## è§£æ±ºç­–

### Sail ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•

ã¾ãš Codespaces ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ã„ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å‹•ã‹ã™ï¼

```sh
# å¿…è¦ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç”¨æ„
mkdir -p storage/framework/cache/data/
mkdir -p storage/framework/app/cache
mkdir -p storage/framework/sessions
mkdir -p storage/framework/views

# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
docker run --rm \
    -u "$(id -u):$(id -g)" \
    -v $(pwd):/var/www/html \
    -w /var/www/html \
    laravelsail/php82-composer:latest \
    composer install --ignore-platform-reqs

# .envãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ
# .envã®å†…å®¹ã¯ä½œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«åˆã‚ã›ã¦ãŠãï¼
cp .env.example .env

# ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•
./vendor/bin/sail up -d

# ã‚­ãƒ¼ã®ç”Ÿæˆã¨ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
./vendor/bin/sail php artisan key:generate
./vendor/bin/sail php artisan migrate
```

### .env ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿®æ­£

ã“ã®ã¾ã¾ã ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã® URL ãŒ localhost ã«ãªã£ã¦æœ€åˆã®ãƒšãƒ¼ã‚¸ä»¥å¤–èª­ã¿è¾¼ã¾ãªã„ã®ã§ä»¥ä¸‹ã®ã‚ˆã†ã«ä¿®æ­£ã™ã‚‹ï¼

- `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã® `APP_ENV` ã‚’ `codespaces` ã«å¤‰æ›´
- `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã® `APP_URL` ã‚’ Codespaces ã® URLï¼ˆã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•ã—ãŸæ™‚ã«å‡ºã¦ãã‚‹ URLï¼‰ã«å¤‰æ›´

```txt
APP_NAME=Laravel
APP_ENV=codespaces
APP_KEY=base64:hogehogefugafuga
APP_DEBUG=true
APP_TIMEZONE=UTC
APP_URL=https://hoge-fuga-piyo-80.app.github.dev/
```

### Provider ã®ä¿®æ­£

ã“ã®ã¾ã¾ã ã¨ã€ãªãœã‹ `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ãŒåæ˜ ã•ã‚Œãªã„ã®ã§ `app/Providers/AppServiceProvider.php` ã® `boot` ãƒ¡ã‚½ãƒƒãƒ‰ã«ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚‹ï¼

```php
public function boot(): void
{
  if (config('app.env') === 'codespaces') {
    URL::forceRootUrl(config('app.url'));
    if (str_contains(config('app.url'), 'https://')) {
      URL::forceScheme('https');
    }
  }
}
```

### å†…å®¹ã‚’åæ˜ 

æœ€å¾Œã«ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦è¨­å®šã‚’åæ˜ ã•ã›ã‚‹ï¼

```sh
./vendor/bin/sail artisan config:cache

   INFO  Configuration cached successfully.

```

## ã¾ã¨ã‚

ãªãœã‹ `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ãŒåæ˜ ã•ã‚Œãªã„ç¾è±¡ãŒèµ·ãã¦ãƒãƒã£ãŸï¼ Provider ã§å¼·åˆ¶çš„ã« URL ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã§è§£æ±ºã—ãŸï¼ä»–ã«å½±éŸ¿ãŒå‡ºãŸã‚‰ã¾ãŸè¿½è¨˜ã™ã‚‹ï¼

ä»¥ä¸Šã ( `ï½¥Ï‰ï½¥)b

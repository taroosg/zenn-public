---
title: "Laravel ã§å¤šå¯¾å¤šã®ç›¸æ‰‹ã‚’ whereIn ã§æŒ‡å®šã—ãŸã„"
emoji: "ğŸ”—"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["laravel", "php"]
published: true
---

æ„å¤–ã¨ä½¿ã†æ©Ÿä¼šãŒãªãã¦ãƒãƒã£ãŸã®ã§å‚™å¿˜éŒ²ï¼

## çŠ¶æ³

- articles ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ users ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã™ã‚‹ï¼

- user ã¯ article ã« like ã™ã‚‹ã“ã¨ãŒã§ãï¼Œuser ã¨ article ã¯å¤šå¯¾å¤šã¨ãªã£ã¦ã„ã‚‹ï¼

- æŒ‡å®šã—ãŸãƒ¦ãƒ¼ã‚¶ï¼ˆè¤‡æ•°ï¼‰ãŒ like ã—ãŸ article ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ãŸã„ï¼

## ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹æˆ

### articles

| id  | text |
| --- | ---- |
| 1   | hoge |
| 2   | fuga |
| 3   | piyo |
| 4   | foo  |
| 5   | bar  |
| 6   | baz  |

### users

| id  | name       |
| --- | ---------- |
| 1   | Giorno     |
| 2   | Bucciarati |
| 3   | Mista      |
| 4   | Abbacchio  |
| 5   | Fugo       |

### article_user

| article_id | user_id |
| ---------- | ------- |
| 1          | 1       |
| 1          | 2       |
| 2          | 2       |
| 3          | 3       |
| 4          | 3       |
| 4          | 4       |

## è§£æ±ºç­–

ä¾‹ãˆã°ï¼Œarticle_user ãƒ†ãƒ¼ãƒ–ãƒ«ã® user_id ãŒ 1, 2, 4 ã®ã‚‚ã®ã‚’å–å¾—ã—ãŸã„ã¨ã™ã‚‹ï¼

äºˆã‚ user ã® id ã®é…åˆ—ã‚’ä½œã£ã¦ãŠãï¼ŒwhereIn ã®ç¬¬ 2 å¼•æ•°ã‚’åˆ©ç”¨ã™ã‚Œã° OKï¼

```php
// user ã® id ã®é…åˆ—ã‚’ç”¨æ„ã—ã¦ãŠãï¼
$users = [1, 2, 4];

// ç¬¬ 2 å¼•æ•°ã«ã‚¯ã‚¨ãƒªã‚’æ¸¡ã—ï¼Œä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«ã« whereIn ã‚’ä½¿ã†ï¼
$articles = Article::whereIn(
  'id',
  fn ($query) =>
  $query->select('article_id')
    ->from('article_user')
    ->whereIn('user_id', $users)
);

```

ä»¥ä¸Šã ( `ï½¥Ï‰ï½¥)b
